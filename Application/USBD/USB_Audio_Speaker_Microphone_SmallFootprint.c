/*********************************************************************
*                     SEGGER Microcontroller GmbH                    *
*                        The Embedded Experts                        *
**********************************************************************
*                                                                    *
*       (c) 2003 - 2019  SEGGER Microcontroller GmbH                 *
*                                                                    *
*       www.segger.com     Support: support@segger.com               *
*                                                                    *
**********************************************************************
-------------------------- END-OF-HEADER -----------------------------

File    : USB_Audio_Speaker_Microphone_SmallFootprint.c
Purpose : This sample is designed to demonstrate emUSB-Device's Audio class.
          It is designed for target with little flash and RAM.

Additional information:
  Preparations:
    For the speaker component:
    After connecting the eval board via USB and starting the application
    make sure emUSB-Device-Audio is the default output sound device.

    For the microphone component:
    Select your physical speakers (or headphones) as the default output device.
    Select the emUSB-Device-Audio microphone as the default input sound device.
    Enable loop-back on the emUSB-Device-Audio microphone.

  Expected behavior:
    When the device is connected to a PC and audio is played the sample
    will count how many audio samples are audible and how many are not.
    The respective counts will be printed to the debug terminal.

    When listening to the microphone input a steady beat is heard.

  Sample output:
    <...>

    11:405 MainTask - Received 6834 silent samples and 1332 audible samples so far.
    12:405 MainTask - Received 7834 silent samples and 1332 audible samples so far.
    13:405 MainTask - Received 8834 silent samples and 1332 audible samples so far.
    14:405 MainTask - Received 9834 silent samples and 1332 audible samples so far.
    15:405 MainTask - Received 10518 silent samples and 1649 audible samples so far.
    16:405 MainTask - Received 10518 silent samples and 2649 audible samples so far.
    17:405 MainTask - Received 10518 silent samples and 3649 audible samples so far.
    18:405 MainTask - Received 10518 silent samples and 4649 audible samples so far.
    19:405 MainTask - Received 10518 silent samples and 5649 audible samples so far.
    20:405 MainTask - Received 11014 silent samples and 6153 audible samples so far.
    21:405 MainTask - Received 12014 silent samples and 6153 audible samples so far.
    22:405 MainTask - Received 13015 silent samples and 6153 audible samples so far.
    23:405 MainTask - Received 14015 silent samples and 6153 audible samples so far.
    24:405 MainTask - Received 15015 silent samples and 6153 audible samples so far.

    <...>
*/

/*********************************************************************
*
*       #include section
*
**********************************************************************
*/
#include <stdio.h>
#include "USB_Audio.h"
#include "RTOS.h"
#include "FS.h"
#include "BSP.h"

/*********************************************************************
*
*       Defines, configurable
*
**********************************************************************
*/
#define NUM_BUFFERS                   2
#define MAX_TIMEOUT_COUNT           100
#define READ_TIMEOUT                 10
#define WRITE_TIMEOUT                10
#define MAX_UNHANDLED_RECEIVE      1000
#define MAX_SILENT_PACKET          2000

#define INIT_WAV     0x01
#define CLOSE_WAV    0x02
#define BUFFER_FULL  0x03

/*********************************************************************
*
*       Defines, fixed
*
**********************************************************************
*/
#define PACKET_SIZE_OUT 192 // Has to match the configured values in _SpeakerConfig
#define PACKET_SIZE_IN  16  // Has to match the configured values in _MicConfig

/*********************************************************************
*
*       Static const data
*
**********************************************************************
*/

//
//  Information that is used during enumeration.
//
static const USB_DEVICE_INFO _DeviceInfo = {
  0x8765,         // VendorId
  0x1313,         // ProductId
  "SEGGER",       // VendorName
  "Audio Headset",// ProductName
  "13245678"      // SerialNumber
};

static const unsigned char beat_8000_mono_wav[] = {
  0x04, 0x00, 0xfe, 0xff, 0xff, 0xff, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00,
  0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00,
  0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff,
  0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00,
  0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00,
  0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x05, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff,
  0x04, 0x00, 0xfc, 0xff, 0x02, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x05, 0x00, 0xfa, 0xff, 0x04, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x03, 0x00, 0xfb, 0xff, 0x05, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff,
  0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00,
  0x00, 0x00, 0xff, 0xff, 0x03, 0x00, 0xfb, 0xff, 0x05, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfe, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff,
  0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00,
  0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff, 0xff, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff, 0xff, 0xff, 0x03, 0x00, 0xfb, 0xff, 0x06, 0x00, 0xfa, 0xff, 0x05, 0x00,
  0xfd, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00,
  0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfd, 0xff, 0x03, 0x00,
  0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff,
  0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfb, 0xff, 0x05, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff,
  0x03, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfc, 0xff,
  0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x01, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00,
  0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00,
  0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff,
  0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00,
  0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x03, 0x00,
  0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00,
  0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x02, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff,
  0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
  0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00,
  0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xff, 0xff, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00,
  0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00,
  0x00, 0x00, 0xff, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff,
  0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00, 0xff, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00,
  0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xff, 0xff, 0xff, 0xff, 0x03, 0x00, 0xfb, 0xff, 0x06, 0x00, 0xfa, 0xff, 0x05, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfd, 0xff,
  0x04, 0x00, 0xfd, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00,
  0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x03, 0x00,
  0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00,
  0xfe, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff,
  0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff,
  0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfb, 0xff, 0x05, 0x00, 0xfb, 0xff, 0x05, 0x00, 0xfb, 0xff, 0x05, 0x00, 0xfc, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00,
  0xfb, 0xff, 0x04, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff,
  0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00,
  0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00,
  0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff,
  0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00,
  0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00,
  0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x04, 0x00,
  0xfb, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00,
  0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff,
  0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00,
  0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfb, 0xff, 0x06, 0x00,
  0xfb, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00, 0xfd, 0xff, 0x05, 0x00, 0xfb, 0xff, 0x03, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00,
  0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfe, 0xff,
  0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00,
  0xff, 0xff, 0xff, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff,
  0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff,
  0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfe, 0xff,
  0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00,
  0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xff, 0xff, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x02, 0x00,
  0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00,
  0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0xf2, 0xfe, 0x12, 0x05, 0x45, 0xfd, 0x72, 0xef, 0x06, 0x09, 0x58, 0x25, 0x8a, 0xf9, 0xc7, 0xc6, 0xdf, 0xf1, 0x99, 0x3a, 0x95, 0x26, 0xc1, 0xd9, 0xcc, 0xd1,
  0xc5, 0x01, 0xd2, 0x29, 0x45, 0x25, 0x01, 0xea, 0x79, 0xc7, 0xca, 0xee, 0x87, 0x28, 0xef, 0x25, 0xb9, 0xfb, 0xbe, 0xeb, 0xe1, 0xf3, 0xa0, 0xfd, 0xaf, 0xfd, 0x18, 0x03, 0xf8, 0x0c, 0x9e, 0x04,
  0xa4, 0xf8, 0xdd, 0xf8, 0x06, 0x02, 0x2d, 0x0f, 0x2b, 0x03, 0x5d, 0xe6, 0x8e, 0xf1, 0xc5, 0x15, 0x27, 0x14, 0x64, 0xf3, 0x3a, 0xec, 0xb3, 0x06, 0x6c, 0x1b, 0xd4, 0x0b, 0x5a, 0xe4, 0x9f, 0xd8,
  0xb2, 0x01, 0x1f, 0x29, 0x5c, 0x17, 0x58, 0xf0, 0x9e, 0xec, 0x29, 0x01, 0x3b, 0x04, 0xd2, 0xfd, 0xc1, 0xf9, 0x0b, 0xfe, 0x74, 0x0b, 0x15, 0x0c, 0x71, 0xfc, 0x15, 0xf3, 0x0f, 0xfa, 0xef, 0x05,
  0xf9, 0x07, 0xd8, 0xfe, 0xde, 0xf9, 0x74, 0xfd, 0x22, 0x02, 0x88, 0x05, 0xe2, 0x02, 0x1d, 0xfb, 0x3e, 0xfa, 0xf5, 0x02, 0xe7, 0x06, 0xb6, 0xff, 0x86, 0xf8, 0x77, 0xfa, 0x83, 0x03, 0x75, 0x0a,
  0x91, 0x05, 0x9e, 0xf8, 0x51, 0xf4, 0x3f, 0xfe, 0x26, 0x08, 0x60, 0x07, 0xc7, 0x00, 0x84, 0xfa, 0xbf, 0xf9, 0xae, 0xff, 0x1e, 0x05, 0x0a, 0x05, 0x2a, 0x00, 0x2c, 0xfb, 0xbe, 0xfa, 0x6e, 0xff,
  0x83, 0x05, 0x0b, 0x06, 0xc0, 0xfe, 0x8c, 0xf9, 0xfd, 0xfd, 0xf9, 0x03, 0x0e, 0x02, 0x3e, 0xfd, 0x54, 0xfd, 0x53, 0x01, 0xfc, 0x04, 0x38, 0x02, 0x35, 0xfb, 0x9b, 0xfa, 0xa1, 0x01, 0xe8, 0x05,
  0x68, 0x00, 0x88, 0xfa, 0x16, 0xff, 0xdd, 0x04, 0x31, 0x03, 0xf3, 0xfd, 0xe6, 0xf9, 0x83, 0xfc, 0xc6, 0x05, 0x61, 0x08, 0x6d, 0xfe, 0x0a, 0xf7, 0xb7, 0xfc, 0x13, 0x05, 0x96, 0x05, 0x50, 0x00,
  0x76, 0xfb, 0x4b, 0xfc, 0x82, 0x01, 0x4a, 0x03, 0xf8, 0x00, 0xa2, 0xff, 0xc3, 0xfe, 0xec, 0xfd, 0x59, 0xff, 0xe0, 0x01, 0x75, 0x03, 0xa1, 0x00, 0x7f, 0xfb, 0x71, 0xfc, 0x96, 0x03, 0xa0, 0x05,
  0xd6, 0xfd, 0xe2, 0xf8, 0x50, 0xff, 0xd8, 0x07, 0xfb, 0x05, 0xb4, 0xfb, 0xb1, 0xf5, 0x53, 0xfc, 0x51, 0x08, 0xdc, 0x09, 0xc7, 0xfe, 0x8d, 0xf7, 0x70, 0xfb, 0x85, 0x02, 0x51, 0x05, 0xf2, 0x01,
  0xc0, 0xfd, 0x3b, 0xfd, 0x67, 0xfe, 0x99, 0x00, 0x8a, 0x02, 0xda, 0x02, 0xe8, 0x00, 0x8e, 0xfc, 0xdc, 0xfa, 0x1e, 0x00, 0x51, 0x05, 0xa0, 0x02, 0x94, 0xfd, 0xef, 0xfd, 0xb7, 0x00, 0x8d, 0x01,
  0xcf, 0xff, 0xc5, 0xfc, 0xe5, 0xfe, 0x5a, 0x03, 0x9c, 0x02, 0x42, 0xff, 0x16, 0xfe, 0x54, 0xff, 0x43, 0x00, 0x0f, 0xff, 0x9d, 0xff, 0x0f, 0x02, 0x2f, 0x02, 0x90, 0xff, 0x53, 0xfc, 0x24, 0xfe,
  0xb3, 0x03, 0xa5, 0x03, 0x5e, 0xfd, 0x23, 0xfb, 0x14, 0x00, 0xab, 0x04, 0x55, 0x03, 0x28, 0xfe, 0x9a, 0xfa, 0x26, 0xfe, 0x19, 0x04, 0xf2, 0x03, 0x0a, 0xff, 0xdb, 0xfb, 0xdd, 0xfe, 0x0e, 0x03,
  0xa5, 0x01, 0xfd, 0xfe, 0x70, 0xfe, 0xf1, 0xfe, 0x73, 0x01, 0x6b, 0x02, 0xd5, 0xfe, 0x9a, 0xfc, 0x20, 0x00, 0x68, 0x03, 0xf8, 0x01, 0xe6, 0xfe, 0xe1, 0xfc, 0x82, 0xfd, 0x66, 0x01, 0xd0, 0x03,
  0x90, 0x01, 0x79, 0xfe, 0xcd, 0xfd, 0xa8, 0xfe, 0xf8, 0xff, 0x03, 0x02, 0x5a, 0x02, 0x98, 0xff, 0x34, 0xfd, 0x35, 0xfe, 0x18, 0x01, 0xe1, 0x02, 0x9a, 0x01, 0x1a, 0xfe, 0xb8, 0xfc, 0xca, 0xff,
  0xf8, 0x02, 0x7d, 0x01, 0x36, 0xfe, 0x43, 0xfe, 0xe7, 0x00, 0xef, 0x01, 0x4d, 0x00, 0xe8, 0xfd, 0x54, 0xfe, 0x4f, 0x01, 0x15, 0x02, 0xaf, 0xff, 0xb5, 0xfe, 0x37, 0x00, 0xe0, 0x00, 0x62, 0xff,
  0x94, 0xfe, 0x23, 0x00, 0xeb, 0x01, 0x3f, 0x01, 0x6e, 0xfe, 0x41, 0xfd, 0xa2, 0x00, 0x99, 0x03, 0xd6, 0x00, 0xad, 0xfc, 0x8a, 0xfd, 0x7a, 0x01, 0x38, 0x03, 0x12, 0x01, 0xaf, 0xfd, 0x4e, 0xfd,
  0xa0, 0x00, 0x82, 0x02, 0xbd, 0x00, 0x6b, 0xfe, 0xa6, 0xfe, 0xd8, 0x00, 0x44, 0x01, 0xca, 0xff, 0x51, 0xff, 0xb3, 0xff, 0x16, 0x00, 0x88, 0x00, 0x23, 0x00, 0x4f, 0xff, 0xa7, 0xff, 0xb6, 0x00,
  0xac, 0x00, 0xfc, 0xff, 0x88, 0xff, 0x2b, 0xff, 0x73, 0xff, 0x96, 0x00, 0x38, 0x01, 0x9e, 0x00, 0x7b, 0xff, 0xe7, 0xfe, 0x21, 0xff, 0x4c, 0x00, 0x76, 0x01, 0xd0, 0x00, 0x29, 0xff, 0xb2, 0xfe,
  0xb6, 0xff, 0xf5, 0x00, 0x0b, 0x01, 0xe9, 0xff, 0xf3, 0xfe, 0x5e, 0xff, 0x94, 0x00, 0xd3, 0x00, 0xd8, 0xff, 0x37, 0xff, 0xdf, 0xff, 0xbb, 0x00, 0x7e, 0x00, 0x9e, 0xff, 0x3c, 0xff, 0xd1, 0xff,
  0xa9, 0x00, 0x5b, 0x00, 0xaa, 0xff, 0xdc, 0xff, 0x4d, 0x00, 0x15, 0x00, 0x84, 0xff, 0x9f, 0xff, 0x66, 0x00, 0xb5, 0x00, 0x05, 0x00, 0x26, 0xff, 0x6d, 0xff, 0xd3, 0x00, 0x05, 0x01, 0xa3, 0xff,
  0xbd, 0xfe, 0xa2, 0xff, 0xe3, 0x00, 0xf1, 0x00, 0xe9, 0xff, 0x1a, 0xff, 0x73, 0xff, 0x77, 0x00, 0xa1, 0x00, 0xf6, 0xff, 0x8a, 0xff, 0xd1, 0xff, 0x4f, 0x00, 0x3a, 0x00, 0xdd, 0xff, 0xe4, 0xff,
  0xf6, 0xff, 0xf7, 0xff, 0x19, 0x00, 0x0e, 0x00, 0xe7, 0xff, 0xf5, 0xff, 0x19, 0x00, 0x1d, 0x00, 0x04, 0x00, 0xeb, 0xff, 0xc6, 0xff, 0xdc, 0xff, 0x32, 0x00, 0x59, 0x00, 0x17, 0x00, 0xc9, 0xff,
  0xb4, 0xff, 0xe2, 0xff, 0x32, 0x00, 0x4d, 0x00, 0x10, 0x00, 0xc2, 0xff, 0xcb, 0xff, 0x07, 0x00, 0x31, 0x00, 0x20, 0x00, 0xf1, 0xff, 0xdb, 0xff, 0xf1, 0xff, 0x18, 0x00, 0x15, 0x00, 0xf3, 0xff,
  0xeb, 0xff, 0x05, 0x00, 0x19, 0x00, 0x04, 0x00, 0xf4, 0xff, 0xec, 0xff, 0x00, 0x00, 0x11, 0x00, 0x02, 0x00, 0xfd, 0xff, 0xfd, 0xff, 0x08, 0x00, 0xfb, 0xff, 0xfb, 0xff, 0xfd, 0xff, 0x06, 0x00,
  0x03, 0x00, 0x00, 0x00, 0xfd, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff,
  0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
  0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe, 0xff,
  0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00,
  0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00,
  0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00,
  0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfc, 0xff,
  0x03, 0x00, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x01, 0x00,
  0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfd, 0xff,
  0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00,
  0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00,
  0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00,
  0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff,
  0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00,
  0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfc, 0xff, 0x06, 0x00, 0xf9, 0xff, 0x07, 0x00, 0xfa, 0xff, 0x05, 0x00,
  0xfb, 0xff, 0x05, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x04, 0x00,
  0xfc, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfe, 0xff,
  0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00,
  0x02, 0x00, 0xfc, 0xff, 0x05, 0x00, 0xfb, 0xff, 0x04, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff,
  0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00,
  0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfc, 0xff, 0x05, 0x00, 0xfa, 0xff, 0x06, 0x00, 0xfc, 0xff, 0x02, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00, 0xfe, 0xff,
  0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x05, 0x00, 0xfb, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xfe, 0xff,
  0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00,
  0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfb, 0xff, 0x07, 0x00, 0xf9, 0xff, 0x05, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff,
  0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff, 0xff, 0xff,
  0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0xff, 0xff, 0x03, 0x00,
  0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff,
  0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00,
  0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00,
  0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff,
  0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfc, 0xff,
  0x03, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff,
  0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfe, 0xff,
  0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00,
  0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00,
  0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00,
  0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00,
  0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x03, 0x00, 0xfb, 0xff, 0x06, 0x00, 0xfa, 0xff, 0x06, 0x00, 0xfb, 0xff, 0x03, 0x00, 0xff, 0xff, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00,
  0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff,
  0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00,
  0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0xff, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff,
  0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x05, 0x00, 0xfb, 0xff, 0x05, 0x00, 0xfb, 0xff, 0x04, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff,
  0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfc, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff,
  0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfe, 0xff,
  0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff,
  0x04, 0x00, 0xfd, 0xff, 0x01, 0x00, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00,
  0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x04, 0x00, 0xfb, 0xff, 0x04, 0x00, 0xfd, 0xff,
  0x02, 0x00, 0xff, 0xff, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff,
  0x02, 0x00, 0xff, 0xff, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff,
  0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff,
  0x01, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
  0x02, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0xff, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x05, 0x00, 0xfb, 0xff, 0x04, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00,
  0xff, 0xff, 0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff,
  0x01, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x04, 0x00, 0xfb, 0xff, 0x04, 0x00, 0xfd, 0xff,
  0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x03, 0x00, 0xfc, 0xff, 0x03, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xfe, 0xff, 0x02, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00,
  0xfd, 0xff, 0x03, 0x00, 0xfe, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x02, 0x00, 0xfd, 0xff, 0x03, 0x00, 0xfd, 0xff, 0x02, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0xff, 0xff,
  0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x01, 0x00, 0x00, 0x00, 0xff, 0xff, 0x02, 0x00, 0xfd, 0xff
};

static U8           _acBuf[PACKET_SIZE_OUT];
static U32          _CountSilentPacket;
static U32          _CountSoundPacket;

static const USBD_AUDIO_SPEAKER_CONF _SpeakerConfig = {
  0x03,       //Controls
  0x02,       //NrChannels
  0x02,       //SubFrameSize
  0x10,       //BitResolution
  0x0000bb80  //SamFreq
};

static const USBD_AUDIO_MIC_CONF _MicrophoneConfig = {
  0x00,       //Controls
  0x01,       //NrChannels
  0x02,       //SubFrameSize
  0x10,       //BitResolution
  0x00001F40  //SamFreq
};

static OS_STACKPTR int    _AudioRStack[512];
static OS_STACKPTR int    _AudioWStack[512];
static OS_TASK            _AudioR_TCB;
static OS_TASK            _AudioW_TCB;
static const U8         * _pBufMic;


/*********************************************************************
*
*       Static code
*
**********************************************************************
*/

/*********************************************************************
*
*       isSampleSilent
*
*  Function description
*    Checks whether a single stereo, 16 bit audio sample is audible.
*/
static char isSampleSilent (U8 * pBuf, U32 NumBytes) {
  U16 Sample;

  while (NumBytes) {
    Sample = *pBuf | (*(pBuf + 1) << 8);
    pBuf += 2;
    NumBytes -= 2;
    if (!((Sample < 0x0010) || (Sample >= 0xFFF0))) {
      return 0;
    }
  }
  return 1;
}

/*********************************************************************
*
*       _cbOnOut
*
*  Function description
*    Callback called in the context of USBD_AUDIO_Read_Task.
*    Handles data received from the host (OUT direction).
*/
static void _cbOnOut(void * pUserContext, int NumBytesReceived, U8 ** ppNextBuffer, U32 * pNextBufferSize) {
  (void)pUserContext;
  (void)pNextBufferSize;

  if (isSampleSilent(*ppNextBuffer, NumBytesReceived)) {
    _CountSilentPacket++;
  } else {
    _CountSoundPacket++;
  }
}

/*********************************************************************
*
*       _cbOnIn
*
*  Function description
*    Callback called in the context of USBD_AUDIO_Write_Task.
*    Handles data sent to the host (IN direction).
*    The callback sets the write pointer to the next chunk of
*    the static .wav file.
*/
static void _cbOnIn(void * pUserContext, const U8 ** ppNextBuffer, U32 * pNextPacketSize) {
  (void)pUserContext;

  if (_pBufMic == NULL) {
    //
    // First packet
    //
    _pBufMic = beat_8000_mono_wav;
  } else if ((((U32)_pBufMic) + PACKET_SIZE_IN*2) >= ((U32)&beat_8000_mono_wav[sizeof(beat_8000_mono_wav)])) {
    //
    // Last packet
    //
    _pBufMic = beat_8000_mono_wav;
  } else {
    _pBufMic += PACKET_SIZE_IN;
  }
  *ppNextBuffer    = _pBufMic;
  *pNextPacketSize = PACKET_SIZE_IN;
}

/*********************************************************************
*
*       _cbOnControl
*
*  Function description
*    Callback called in ISR context.
*    Receives audio class control commands and sends appropriate
*    responses where necessary.
*/
static int _cbOnControl(void * pUserContext, U8 Event, U8 Unit, U8 ControlSelector, U8 * pBuffer, U32 NumBytes) {
  int r;

  (void)pUserContext;
  (void)Unit;
  (void)NumBytes;
  r = 0;
  switch (Event) {
  case USB_AUDIO_PLAYBACK_START:
    //
    // Host enabled transmission.
    //
    break;
  case USB_AUDIO_PLAYBACK_STOP:
    //
    // Host disabled transmission.
    //
    break;
  case USB_AUDIO_RECORD_START:
    //
    // Host enabled reception.
    //
    break;
  case USB_AUDIO_RECORD_STOP:
    //
    // Host disabled reception.
    //
    break;
  case USB_AUDIO_SET_CUR:
    switch (ControlSelector) {
      case USB_AUDIO_MUTE_CONTROL:
        break;
      case USB_AUDIO_VOLUME_CONTROL:
        break;
      default:
        r = 1;
        break;
    }
    break;
  case USB_AUDIO_GET_CUR:
    switch (ControlSelector) {
      case USB_AUDIO_MUTE_CONTROL:
        pBuffer[0] = 0;
        break;
      case USB_AUDIO_VOLUME_CONTROL:
        pBuffer[0] = 0;
        pBuffer[1] = 0;
        break;
      default:
        pBuffer[0] = 0;
        pBuffer[1] = 0;
        break;
    }
    break;
  case USB_AUDIO_SET_MIN:
    break;
  case USB_AUDIO_GET_MIN:
    switch (ControlSelector) {
      case USB_AUDIO_VOLUME_CONTROL:
        pBuffer[0] = 0;
        pBuffer[1] = 0xf1;
        break;
      default:
        pBuffer[0] = 0;
        pBuffer[1] = 0;
        break;
    }
    break;
  case USB_AUDIO_SET_MAX:
    break;
  case USB_AUDIO_GET_MAX:
    switch (ControlSelector) {
      case USB_AUDIO_VOLUME_CONTROL:
        pBuffer[0] = 0;
        pBuffer[1] = 0;
        break;
      default:
        pBuffer[0] = 0;
        pBuffer[1] = 0;
        break;
    }
    break;
  case USB_AUDIO_SET_RES:
    break;
  case USB_AUDIO_GET_RES:
    switch (ControlSelector) {
      case USB_AUDIO_VOLUME_CONTROL:
        pBuffer[0] = 0;
        pBuffer[1] = 1;
        break;
      default:
        pBuffer[0] = 0;
        pBuffer[1] = 0;
        break;
    }
    break;
  default:
    r = 1;
    break;
  }
  return r;
}

/*********************************************************************
*
*       _AddAudio
*
*  Function description
*    Add a USB Audio interface to the USB stack.
*/
static USBD_AUDIO_HANDLE _AddAudio(void) {
  static U8             _abOutBuffer[PACKET_SIZE_OUT];
  USB_ADD_EP_INFO       EPOut;
  USB_ADD_EP_INFO       EPIn;
  USBD_AUDIO_INIT_DATA  InitData;
  USBD_AUDIO_HANDLE     hInst;

  EPOut.Flags = 0;
  EPOut.InDir = USB_DIR_OUT;
  EPOut.Interval = 8;
  EPOut.MaxPacketSize = PACKET_SIZE_OUT;
  EPOut.TransferType = USB_TRANSFER_TYPE_ISO;
  EPIn.Flags = 0;
  EPIn.InDir = USB_DIR_IN;
  EPIn.Interval = 8;
  EPIn.MaxPacketSize = PACKET_SIZE_IN;
  EPIn.TransferType = USB_TRANSFER_TYPE_ISO;
  memset(&InitData, 0, sizeof(InitData));
  InitData.EPOut = USBD_AddEPEx(&EPOut, _abOutBuffer, PACKET_SIZE_OUT);
  InitData.EPIn  = USBD_AddEPEx(&EPIn, NULL, PACKET_SIZE_IN);
  InitData.pBufOut = _acBuf;
  InitData.pBufIn  = NULL;
  InitData.pfOnOut = _cbOnOut;
  InitData.pfOnIn  = _cbOnIn;
  InitData.ReadTimeout = READ_TIMEOUT;
  InitData.WriteTimeout = WRITE_TIMEOUT;
  InitData.OutPacketSize = PACKET_SIZE_OUT;
  InitData.InPacketSize  = PACKET_SIZE_IN;
  InitData.pfOnControl = _cbOnControl;
  InitData.pSpeakerConf = &_SpeakerConfig;
  InitData.pMicConf = &_MicrophoneConfig;
  hInst = USBD_AUDIO_Add(&InitData);
  return hInst;
}

/*********************************************************************
*
*       Public code
*
**********************************************************************
*/

/*********************************************************************
*
*       MainTask
*
* Function description
*   USB handling task.
*/
#ifdef __cplusplus
extern "C" {     /* Make sure we have C-declarations in C++ programs */
#endif
void MainTask(void);
#ifdef __cplusplus
}
#endif
void MainTask(void) {
  USBD_AUDIO_HANDLE hInst;

  USBD_Init();
  hInst = _AddAudio();
  USBD_SetDeviceInfo(&_DeviceInfo);
  USBD_Start();
  OS_CREATETASK(&_AudioW_TCB,  "Audio Write Task", USBD_AUDIO_Write_Task, 240, _AudioWStack);
  OS_CREATETASK(&_AudioR_TCB,  "Audio Read Task",  USBD_AUDIO_Read_Task, 250, _AudioRStack);

  while (1) {
    //
    // Wait for configuration
    //
    while ((USBD_GetState() & (USB_STAT_CONFIGURED | USB_STAT_SUSPENDED)) != USB_STAT_CONFIGURED) {
      BSP_ToggleLED(0);
      USB_OS_Delay(50);
    }
    _CountSilentPacket = 0;
    _CountSoundPacket  = 0;
    USBD_AUDIO_Start_Listen(hInst);
    USBD_AUDIO_Start_Play(hInst);
    while ((USBD_GetState() & (USB_STAT_CONFIGURED | USB_STAT_SUSPENDED)) == USB_STAT_CONFIGURED) {
      USB_OS_Delay(1000);
      USB_LOG((USB_MTYPE_INFO,"Received %d silent samples and %d audible samples so far.", _CountSilentPacket, _CountSoundPacket));
    }
    USBD_AUDIO_Stop_Listen(hInst);
    USBD_AUDIO_Stop_Play(hInst);
  }
}

/**************************** end of file ***************************/
